python qwen_vae_benchmark.py --warmup 0
========================================================================
Qwen-Image VAE Micro-Benchmark (Standalone)
========================================================================
PyTorch                : 2.7.1+rocm7.0.0rc20250903
HIP (torch.version.hip): 7.1.25353-0cbc13abe8
ROCm pkg version       : 7.0.0rc20250903
Kernel                 : 6.16.3-200.fc42.x86_64  (#1 SMP PREEMPT_DYNAMIC Sat Aug 23 17:02:17 UTC 2025)
Distro                 : Fedora Linux 44 (Container Image Prerelease)
GPU:
  torch_device_name: AMD Radeon Graphics
  marketing_name: AMD RYZEN AI MAX+ 395 w/ Radeon 8060S
  gfx_name: gfx1151

VAE scaling_factor     : 0.18215
VAE downsample factor  : 8x

Shapes being tested (1664x928):
  Encode input (image) : (1, 3, 928, 1664)
    ~17.67 MiB  (18.53 MB) @ float32
    ~8.84 MiB  (9.27 MB) @ bfloat16 (autocast)
  Decode input (latent): (1, 16, 116, 208)
    ~1.47 MiB  (1.54 MB) @ float32
    ~0.74 MiB  (0.77 MB) @ bfloat16 (autocast)
  Resolution           : 1664x928  â†’  Latent: 208x116  (down=8x)

-- Test: fp32-baseline
   dtype=fp32, tiled=False, env=default
   Encode: 36.3510s   Decode: 56.7277s

-- Test: bf16-baseline
   dtype=bf16, tiled=False, env=default
   Encode: 35.4282s   Decode: 55.8300s

-- Test: fp32-fastfind
   dtype=fp32, tiled=False, env={'MIOPEN_FIND_MODE': '2'}
   Encode: 35.3824s   Decode: 56.1173s

-- Test: fp32-disable-naive
   dtype=fp32, tiled=False, env={'MIOPEN_DEBUG_CONV_DIRECT_NAIVE_CONV_FWD': '0'}
   Encode: 35.2088s   Decode: 56.0296s

-- Test: fp32-tiled
   dtype=fp32, tiled=native, env=default, tile_px=auto
   Encode: 8.1428s   Decode: 12.4070s

-- Test: bf16-tiled
   dtype=bf16, tiled=native, env=default
   Encode: 3.0389s   Decode: 4.9402s

-- Test: fp32-tiled-fastfind
   dtype=fp32, tiled=native, env={'MIOPEN_FIND_MODE': '2'}
   Encode: 7.7063s   Decode: 12.1946s

-- Test: fp32-tiled-disable-naive
   dtype=fp32, tiled=native, env={'MIOPEN_DEBUG_CONV_DIRECT_NAIVE_CONV_FWD': '0'}
   Encode: 7.6796s   Decode: 12.2024s


== Summary (sorted by total time) ==
name          dtype         tiled         encode_s      decode_s      total_s     
----------------------------------------------------------------------------------
bf16-tiled    bf16          True          3.0389        4.9402        7.9791      
fp32-tiled-disable-naive  fp32          True          7.6796        12.2024       19.8820     
fp32-tiled-fastfind  fp32          True          7.7063        12.1946       19.9010     
fp32-tiled    fp32          True          8.1428        12.4070       20.5498     
fp32-disable-naive  fp32          False         35.2088       56.0296       91.2384     
bf16-baseline  bf16          False         35.4282       55.8300       91.2581     
fp32-fastfind  fp32          False         35.3824       56.1173       91.4997     
fp32-baseline  fp32          False         36.3510       56.7277       93.0787     

